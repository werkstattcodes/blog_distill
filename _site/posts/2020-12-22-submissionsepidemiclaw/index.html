<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>werk.statt.codes: Similarity of public submissions to Austria's amendment of the epidemic law</title>

<meta property="description" itemprop="description" content="An analysis of public submissions to bill seeking to amend Austria&#39;s epidemic law."/>

<link rel="canonical" href="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-12-22"/>
<meta property="article:created" itemprop="dateCreated" content="2020-12-22"/>
<meta name="article:author" content="Roland Schmidt"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="werk.statt.codes: Similarity of public submissions to Austria&#39;s amendment of the epidemic law"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="An analysis of public submissions to bill seeking to amend Austria&#39;s epidemic law."/>
<meta property="og:url" content="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"/>
<meta property="og:image" content="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/submissionsepidemiclaw_files/preview.png"/>
<meta property="og:image:width" content="1086"/>
<meta property="og:image:height" content="685"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="werk.statt.codes"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="werk.statt.codes: Similarity of public submissions to Austria&#39;s amendment of the epidemic law"/>
<meta property="twitter:description" content="An analysis of public submissions to bill seeking to amend Austria&#39;s epidemic law."/>
<meta property="twitter:url" content="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"/>
<meta property="twitter:image" content="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/submissionsepidemiclaw_files/preview.png"/>
<meta property="twitter:image:width" content="1086"/>
<meta property="twitter:image:height" content="685"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="werk.statt.codes: Similarity of public submissions to Austria&#39;s amendment of the epidemic law"/>
<meta name="citation_fulltext_html_url" content="https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2020/12/22"/>
<meta name="citation_publication_date" content="2020/12/22"/>
<meta name="citation_author" content="Roland Schmidt"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","date","author","categories","preview","output","creative_commons","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Similarity of public submissions to Austria's amendment of the epidemic law"]},{"type":"character","attributes":{},"value":["An analysis of public submissions to bill seeking to amend Austria's epidemic law."]},{"type":"character","attributes":{},"value":["12-22-2020"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["first_name","last_name","url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Roland"]},{"type":"character","attributes":{},"value":["Schmidt"]},{"type":"character","attributes":{},"value":["https://werk.statt.codes"]},{"type":"character","attributes":{},"value":["0000-0002-6897-1693"]}]}]},{"type":"character","attributes":{},"value":["Austria","Corona virus","OCR","stringr","web scraping"]},{"type":"character","attributes":{},"value":["submissionsepidemiclaw_files/preview.png"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","toc_float","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["CC BY-NC-SA"]},{"type":"character","attributes":{},"value":["https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"]},{"type":"character","attributes":{},"value":["https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["submissionsepidemiclaw_files/anchor-4.2.2/anchor.min.js","submissionsepidemiclaw_files/bowser-1.9.3/bowser.min.js","submissionsepidemiclaw_files/core-js-2.5.3/LICENSE","submissionsepidemiclaw_files/core-js-2.5.3/package.json","submissionsepidemiclaw_files/core-js-2.5.3/shim.min.js","submissionsepidemiclaw_files/distill-2.2.21/template.v2.js","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-28-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-30-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-39-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-40-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-42-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-43-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-45-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-46-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-47-1.svg","submissionsepidemiclaw_files/figure-html5/unnamed-chunk-48-1.svg","submissionsepidemiclaw_files/header-attrs-2.6/header-attrs.js","submissionsepidemiclaw_files/htmlwidgets-1.5.3/htmlwidgets.js","submissionsepidemiclaw_files/identify_link.gif","submissionsepidemiclaw_files/jquery-1.11.3/jquery.min.js","submissionsepidemiclaw_files/popper-2.6.0/popper.min.js","submissionsepidemiclaw_files/preview.png","submissionsepidemiclaw_files/react-16.12.0/AUTHORS","submissionsepidemiclaw_files/react-16.12.0/LICENSE.txt","submissionsepidemiclaw_files/react-16.12.0/react-dom.min.js","submissionsepidemiclaw_files/react-16.12.0/react.min.js","submissionsepidemiclaw_files/reactable-binding-0.2.3/reactable.js","submissionsepidemiclaw_files/reactwidget-1.0.0/react-tools.js","submissionsepidemiclaw_files/reactwidget-1.0.0/react-tools.js.map","submissionsepidemiclaw_files/tippy-6.2.7/tippy-bundle.umd.min.js","submissionsepidemiclaw_files/tippy-6.2.7/tippy-light-border.css","submissionsepidemiclaw_files/tippy-6.2.7/tippy.css","submissionsepidemiclaw_files/tippy-6.2.7/tippy.umd.min.js","submissionsepidemiclaw_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css?family=Lato');
@import url('https://fonts.googleapis.com/css?family=PT Serif');
@import url('https://fonts.googleapis.com/css?family=Roboto');
@import url('https://fonts.googleapis.com/css?family=Karla');
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono');
@import url("https://cloud.typography.com/6771036/7342412/css/fonts.css");
@import url('https://fonts.googleapis.com/css2?family=Oswald:wght@200;400&display=swap');


html {
  /*-- Main font sizes --*/
  --title-size:      35px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       unset;
  --text-size:        15px;
  --hover-color:      unset;
  --bkgd-color:       #f0eff0;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

body {
   background-color: #f0eff0; 
}


p {
 text-align: left;
 /*font-family: Lato;*/
 font-size: 100%;
 line-height: 1.3; /*zeilenabstand*/
}


d-title{
   padding-bottom: 0px;
}


d-byline {
    padding-top: 0.5rem;
    padding-bottom: 1rem;
}


pre {
  display: block;
  overflow: auto;
  padding: 9.5px;
  margin: 0 0 10px;
  line-height: 1.4;
  word-break: break-all;
  word-wrap: break-word;
  border: .0px solid #ccc; /* border for code snippets  */
  border-radius: 5px;   
  font-family: monocode, monospace;
  -webkit-font-smoothings: antialiased;
  -moz-osx-font-smoothing: grayscale;
   font-size: 90%;
}



/*@media (min-width: 768px)*/
d-article pre, d-article div.sourceCode, d-article div.sourceCode pre {
    overflow: auto !important;
    overflow-x: auto !important;
    overflow-y: auto !important;
     background-color: #f0eff0; 
}

.distill-site-nav a:not(.title) {
    color: black;
}

.distill-site-nav a:hover:not(.title) {
    color: white;
    background-color: black;
}


/*
.distill-site-header .title {
   max-width: 53px;
   min-width: 53px;
   word-break: break-all;
   text-align: justify;
   background-color: black;
   padding-right: 3px;
   padding-left: 3px;
   padding-top: 2px;
   padding-bottom: 2px;
}
*/

a.title:not(nav-right) {
   color: white;
   font-weight: bold;
   background-color: black;
}

a.title:hover:not(nav-right) {
   color: black;
   font-weight: bold;
   background-color: #f0eff0;
}


/*title of on in listing page*/
.posts-list .description h2 {
    /*font-family: 'Oswald', sans-serif !important;*/
    /*color: red;*/
    font-size: 1.3rem;
}


d-article h2 {
    font-weight: 600;
    font-size: 24px;
    color: red;
    line-height: 1.25em;
    margin: 2rem 0 .5rem 0;
    border-bottom: 0px; 
    /* padding-bottom: 1rem; */
}




.nav-search {
    font-size: larger;
}


/*
.algolia-autocomplete {
    display: inline-flex;
    margin-left: 10px;
    margin-top: 14px;
    vertical-align: top;
    background-color: #f0eff0;
    color: black;
    padding-bottom: 0px;
    padding-top: 0px;
    border-width: 0px;
    border-radius: 0px;
    border-bottom: 0px;
    width: 250px;
    height: 1.2rem;
}

*/

details {
  cursor: pointer;
  margin-bottom:1vh;
  padding: 0em;
  color: gray;
  border: none;
  text-size: 12px;
  text-align: left;
  outline: none;
}

.active, details:hover {
  transition: max-height 0.2s ease-out;
  /* background-color: #acc2c2; */
}

details {
  display: flex;
  justify-content: space-between;
  align-content: center;
  border-radius: 0px;
}

details.active {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

summary::-webkit-details-marker {
  display: none
}

summary::after {
  float: left;
  font-family: "Font Awesome 5 Free";
  content: "\f0fe";
  font-size: 0.7rem;
  padding-right: 5px;
}

details[open] summary::after {
  float: left;
  font-family: "Font Awesome 5 Free";
  content: "\f146";´
  font-size: 0.7rem;
  padding-right: 5px;

}





/*Reactable Formatting*/

.reactable-table {
	font-family: Karla;*/
	font-size:   100%;*/
  
 }

.reactable-title {
/*  color: orange;#333333;*/
  font-size: 100%;
  font-weight: 600;
  font-family: Roboto Condensed;
}
.reactable-subtitle {
  /*color: #7f7f7f;*/
  font-size: 90%;
  font-weight: 100;
  font-family: Roboto Condensed;
  line-height: 100%;
}

.reactable-body {
  /*color: #7f7f7f;*/
  font-size: 80%;*/
  font-weight: 100;*/
  font-family: Karla;*/
  line-height: 100%; */	
}

.reactable-caption {
   /*color: #7f7f7f;*/
  font-size: 70%;
  font-weight: 100;
  line-height: 90%;
  font-family: Roboto Condensed;
  padding-left: 6px;
  white-space: pre;

}

</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.6/header-attrs.js"></script>
  <script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
  <script src="../../site_libs/react-16.12.0/react.min.js"></script>
  <script src="../../site_libs/react-16.12.0/react-dom.min.js"></script>
  <script src="../../site_libs/reactwidget-1.0.0/react-tools.js"></script>
  <script src="../../site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <script src="../../site_libs/reactable-binding-0.2.3/reactable.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Similarity of public submissions to Austria's amendment of the epidemic law","description":"An analysis of public submissions to bill seeking to amend Austria's epidemic law.","authors":[{"author":"Roland Schmidt","authorURL":"https://werk.statt.codes","affiliation":"&nbsp;","affiliationURL":"#","orcidID":"0000-0002-6897-1693"}],"publishedDate":"2020-12-22T00:00:00.000+01:00","citationText":"Schmidt, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">werk.statt.codes</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="https://twitter.com/zoowalk">
<i class="fa fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://www.github.com/werkstattcodes">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Similarity of public submissions to Austria’s amendment of the epidemic law</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Austria" class="dt-tag">Austria</a>
  <a href="../../index.html#category:Corona_virus" class="dt-tag">Corona virus</a>
  <a href="../../index.html#category:OCR" class="dt-tag">OCR</a>
  <a href="../../index.html#category:stringr" class="dt-tag">stringr</a>
  <a href="../../index.html#category:web_scraping" class="dt-tag">web scraping</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>An analysis of public submissions to bill seeking to amend Austria’s epidemic law.</p></p>
</div>

<div class="d-byline">
  
  true
  
<br/>12-22-2020
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#context">Context</a></li>
<li><a href="#get-data">Get data</a>
<ul>
<li><a href="#links-to-submission-subpages">Links to submission subpages</a></li>
<li><a href="#links-to-pdfs">Links to pdfs</a></li>
<li><a href="#download-submissions">Download submissions</a></li>
<li><a href="#extract-text-from-pdfs">Extract text from pdfs</a></li>
</ul></li>
<li><a href="#analysis">Analysis</a>
<ul>
<li><a href="#identify-submissions-with-key-formulation">Identify submissions with key formulation</a></li>
<li><a href="#frequency-of-key-formulation">Frequency of key formulation</a></li>
<li><a href="#distribution-of-length">Distribution of length</a></li>
<li><a href="#submissions-over-time">Submissions over time</a></li>
</ul></li>
<li><a href="#analysis-with-quanteda">Analysis with ‘quanteda’</a>
<ul>
<li><a href="#collocations">Collocations</a></li>
<li><a href="#cosine-similarity">Cosine similarity</a>
<ul>
<li><a href="#document-pairwise-comparison">Document pairwise comparison</a></li>
<li><a href="#groupwise-comparison">Groupwise comparison</a></li>
</ul></li>
<li><a href="#comparision-with-other-bills">Comparision with other bills</a></li>
</ul></li>
<li><a href="#wrap-up">Wrap up</a></li>
</ul>
</nav>
</div>
<h1 id="setup">Setup</h1>
<details closed>
<p><summary>Code: Load packages</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/wch/extrafont'>extrafont</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/extrafont/man/loadfonts.html'>loadfonts</a></span><span class='op'>(</span>device <span class='op'>=</span> <span class='st'>"win"</span>, quiet <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/hrbrmstr/hrbrthemes'>hrbrthemes</a></span><span class='op'>)</span>
<span class='fu'>hrbrthemes</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/hrbrthemes/man/update_geom_font_defaults.html'>update_geom_font_defaults</a></span><span class='op'>(</span>
  family <span class='op'>=</span> <span class='st'>"Roboto Condensed"</span>,
  size <span class='op'>=</span> <span class='fl'>3.5</span>,
  color <span class='op'>=</span> <span class='st'>"grey50"</span>
<span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://scales.r-lib.org'>scales</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://yihui.org/knitr/'>knitr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/EmilHvitfeldt/paletteer'>paletteer</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/ggtext/'>ggtext</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/tidyverse/glue'>glue</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/pdftools'>pdftools</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://rvest.tidyverse.org/'>rvest</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sfirke/janitor'>janitor</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-lib/svglite'>svglite</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/vincentarelbundock/countrycode'>countrycode</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://github.com/collectivemedia/tictoc'>tictoc</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DavisVaughan/furrr'>furrr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/gt'>gt</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glin.github.io/reactable/'>reactable</a></span><span class='op'>)</span>
<span class='fu'>plan</span><span class='op'>(</span><span class='va'>multisession</span>, workers <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<details closed>
<p><summary>Code: Define rmarkdown options</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># knit_hooks$set(wrap = function(before, options, envir) {</span>
<span class='co'>#   if (before) {</span>
<span class='co'>#     paste0("&lt;", options$wrap, "&gt;")</span>
<span class='co'>#   } else {</span>
<span class='co'>#     paste0("&lt;/", options$wrap, "&gt;")</span>
<span class='co'>#   }</span>
<span class='co'># })</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/knitr/man/opts_chunk.html'>opts_chunk</a></span><span class='op'>$</span><span class='fu'>set</span><span class='op'>(</span>
   fig.align <span class='op'>=</span> <span class='st'>"left"</span>,
  message <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warning <span class='op'>=</span> <span class='cn'>FALSE</span>,
   dev <span class='op'>=</span> <span class='st'>"svglite"</span>,
<span class='co'>#  dev.args = list(type = "CairoPNG"),</span>
  dpi <span class='op'>=</span> <span class='fl'>300</span>,
   out.width <span class='op'>=</span> <span class='st'>"100%"</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>180</span>, dplyr.width <span class='op'>=</span> <span class='fl'>150</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<details closed>
<p><summary>Code: Define plot theme, party colors, caption</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>plot_bg_color</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_file.html'>read_file</a></span><span class='op'>(</span>file<span class='op'>=</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"theme.css"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>str_extract</span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"(?&lt;=background-color:).*?(?=;)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='op'>)</span>


<span class='va'>theme_post</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>hrbrthemes</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/hrbrthemes/man/theme_ipsum_rc.html'>theme_ipsum_rc</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme</span><span class='op'>(</span>
      plot.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>plot_bg_color</span>, color<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>,
      panel.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>plot_bg_color</span>, color<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>,
      <span class='co'>#panel.border = element_rect(colour = plot_bg_color, fill=NA),</span>
      <span class='co'>#plot.border = element_rect(colour = plot_bg_color, fill=NA),</span>
      plot.margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>l <span class='op'>=</span> <span class='fl'>0</span>, 
                           t <span class='op'>=</span> <span class='fl'>0.25</span>,
                           unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,
      plot.title <span class='op'>=</span> <span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>
        color <span class='op'>=</span> <span class='st'>"grey20"</span>,
        face <span class='op'>=</span> <span class='st'>"bold"</span>,
        margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>l <span class='op'>=</span> <span class='fl'>0</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,
        size <span class='op'>=</span> <span class='fl'>13</span>
      <span class='op'>)</span>,
      plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
      plot.subtitle <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        color <span class='op'>=</span> <span class='st'>"grey50"</span>,
        margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0.2</span>, b <span class='op'>=</span> <span class='fl'>0.3</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,
        size <span class='op'>=</span> <span class='fl'>11</span>
      <span class='op'>)</span>,
      plot.caption <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        color <span class='op'>=</span> <span class='st'>"grey50"</span>,
        size <span class='op'>=</span> <span class='fl'>8</span>,
        hjust <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>)</span>
      <span class='op'>)</span>,
      plot.caption.position <span class='op'>=</span> <span class='st'>"panel"</span>,
      axis.title.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        angle <span class='op'>=</span> <span class='fl'>0</span>,
        color <span class='op'>=</span> <span class='st'>"grey50"</span>,
        hjust <span class='op'>=</span> <span class='fl'>1</span>
      <span class='op'>)</span>,
      axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        size <span class='op'>=</span> <span class='fl'>9</span>,
        color <span class='op'>=</span> <span class='st'>"grey50"</span>
      <span class='op'>)</span>,
      axis.title.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
      axis.text.y <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        size <span class='op'>=</span> <span class='fl'>9</span>,
        color <span class='op'>=</span> <span class='st'>"grey50"</span>
      <span class='op'>)</span>,
      panel.grid.minor.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
      panel.grid.major.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
      panel.grid.minor.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
      panel.spacing <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.25</span>, <span class='st'>"cm"</span><span class='op'>)</span>,
      panel.spacing.y <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.25</span>, <span class='st'>"cm"</span><span class='op'>)</span>,
      strip.text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        angle <span class='op'>=</span> <span class='fl'>0</span>,
        size <span class='op'>=</span> <span class='fl'>9</span>,
        vjust <span class='op'>=</span> <span class='fl'>1</span>,
        face <span class='op'>=</span> <span class='st'>"bold"</span>
      <span class='op'>)</span>,
      legend.title <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        color <span class='op'>=</span> <span class='st'>"grey30"</span>,
        face <span class='op'>=</span> <span class='st'>"bold"</span>,
        vjust <span class='op'>=</span> <span class='fl'>1</span>,
        size <span class='op'>=</span> <span class='fl'>7</span>
      <span class='op'>)</span>,
      legend.text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>
        size <span class='op'>=</span> <span class='fl'>7</span>,
        color <span class='op'>=</span> <span class='st'>"grey30"</span>
      <span class='op'>)</span>,
      legend.justification <span class='op'>=</span> <span class='st'>"left"</span>,
      legend.box <span class='op'>=</span> <span class='st'>"horizontal"</span>, <span class='co'># arrangement of multiple legends</span>
      legend.direction <span class='op'>=</span> <span class='st'>"vertical"</span>,
      legend.margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>l <span class='op'>=</span> <span class='fl'>0</span>, t <span class='op'>=</span> <span class='fl'>0</span>, unit <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,
      legend.spacing.y <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.07</span>, units <span class='op'>=</span> <span class='st'>"cm"</span><span class='op'>)</span>,
      legend.text.align <span class='op'>=</span> <span class='fl'>0</span>,
      legend.box.just <span class='op'>=</span> <span class='st'>"top"</span>,
      legend.key.height <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='st'>"line"</span><span class='op'>)</span>,
      legend.key.width <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='st'>"line"</span><span class='op'>)</span>,
      text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
    <span class='op'>)</span>
<span class='op'>}</span>

<span class='va'>data_date</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"%d %b %Y"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<h1 id="context">Context</h1>
<p>Austria’s government tabled about three months ago an amendment to the country’s epidemic law. The amendment was largely a reaction to the shortcomings of the law dating from 1950 when confronted with the current Covid crisis as well as a recent ruling of Austria’s Constitutional Court which declared several measures passed by the government as violating the constitution. Hence, the government proposed the amendment.</p>
<p>While there would be a lot to say about the latent tension between civic rights and a state’s obligation to curtail an epidemic or the thin line between legitimate restrictions and excessive infringements, this post will deal with the public submissions to the government’s amendment bill. In short and crude terms, the legislative process in Austria provides the opportunity for citizens, NGOs, expert bodies etc to file submissions in which they can raise their concerns as to the (draft) version of the bill before it will be debated in parliament. So, at least in theory, it’s an avenue for the government to solicit input from the public at large.</p>
<p>What caught my eye, or better my ears, was a related radio news report which mentioned something along the lines that the submissions to the amendment reached a) a record number and b) that a considerable number of submissions were similar in their wording.</p>
<p>I guess the former is indicative for the fundamental issues which the amendment touches and the overall somewhat ‘edgy’, not to say polarized atmosphere when it comes to Corona. The latter point, though, the similarity of submissions’ wording, puzzled me a bit. What the similarity of the wording effectively means is the use of some kind of template by those filing a submission. In this regard, the news report mentioned that there have been some pertaining calls on social media channels to oppose the bill, possibly also including the provision of a template text.</p>
<p>It was this context which made me curious about the extent of the matter. At least curious enough to have an ‘empirical’ look at it with R.</p>
<p>So I went to the a) parliament’s website which provides a record of received submissions, b) extracted the weblinks to all those submissions of which the text is public, c) download the pertaining pdfs, d) extracted their content, and e) finally checked for their similarity. As for the last point, I can gladly report that I learned something here and my approach changed a bit as I moved along. Hence, the blog post somewhat mirrors this process.</p>
<p>When it comes to similarity, my first attempt was to simply look at the the recurrence of a distinct phrase which I repeatedly noticed while randomly glancing through some of the submissions. The formulation is <em>Tür und Tor</em> which means something like ‘(to open) the (flood)gates’. I guess it’s safe to assume that those submissions articulated severe misgivings about the amendment.</p>
<p>As I’ll show below, while this approach is already somewhat informative since it reveals a pervasive use of a rather distinct phrase and hence points towards the use of text template, it is rather inductive and likely to suffer from omissions of other, possibly even more re-current phrases. Furthermore, simply looking at one distinct phrase is likely to be a rather ‘fragile’ indicator. Only a minor, effectively non-substantive modification of the wording would result in missing out on similar submissions.</p>
<p>To make a long story short, this issue introduced me to the world of quantitative text analysis as provided by the powerful <code>quanteda</code> package. Admittedly, I am only starting to scratch the surface here, but hopefully deep enough to legitimately include it in this post. So, enough of context and waffling. In media R(es).</p>
<h1 id="get-data">Get data</h1>
<h2 id="links-to-submission-subpages">Links to submission subpages</h2>
<p>The list of submissions filed for the amendment is provided <a href="https://www.parlament.gv.at/PAKT/VHG/XXVII/ME/ME_00055/index.shtml#tab-Stellungnahmen" target="_blank">here</a> at the Parliament’s website. To extract the links to the sub-pages which include the links to individual texts, I make us of the provided RSS feed. From there I extract the relevant elements and combine them to one dataframe containing the name of the person/institution filing a submission, the submission’s date, and the link to the sub-page.</p>
<details open>
<p><summary>Code: get links to submission sub-pages</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>link_rss_all_submissions</span> <span class='op'>&lt;-</span> <span class='st'>"https://www.parlament.gv.at/PAKT/VHG/XXVII/ME/ME_00055/filter.psp?view=RSS&amp;jsMode=&amp;xdocumentUri=&amp;filterJq=&amp;view=&amp;GP=XXVII&amp;ITYP=ME&amp;INR=55&amp;SUCH=&amp;listeId=142&amp;FBEZ=FP_142"</span>

<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'>xml2</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/read_xml.html'>read_xml</a></span><span class='op'>(</span><span class='va'>link_rss_all_submissions</span><span class='op'>)</span>

<span class='co'>#get link to subpages with link to submissions</span>
<span class='va'>df_submission_pages_link</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>xml2</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/xml_find_all.html'>xml_find_all</a></span><span class='op'>(</span><span class='st'>"//link"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>enframe</span><span class='op'>(</span><span class='va'>.</span>, 
          name<span class='op'>=</span><span class='st'>"id"</span>,
          value<span class='op'>=</span><span class='st'>"link_single_submission_page"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>link_single_submission_page<span class='op'>=</span><span class='fu'>str_squish</span><span class='op'>(</span><span class='va'>link_single_submission_page</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>&gt;</span><span class='fl'>2</span><span class='op'>)</span> <span class='co'>#removes first two rows which don't include data on submissions</span>

<span class='co'>#get title</span>
<span class='va'>df_submission_pages_name</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>xml2</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/xml_find_all.html'>xml_find_all</a></span><span class='op'>(</span><span class='st'>"//title"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>enframe</span><span class='op'>(</span><span class='va'>.</span>, 
          name<span class='op'>=</span><span class='st'>"id"</span>,
          value<span class='op'>=</span><span class='st'>"title"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>name<span class='op'>=</span><span class='fu'>str_extract</span><span class='op'>(</span><span class='va'>title</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"(?&lt;=\\&gt;).*(?=\\&lt;)"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span><span class='op'>&gt;</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>title</span><span class='op'>)</span>

<span class='co'>#get publication date</span>
<span class='va'>df_submission_pages_pub_date</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>xml2</span><span class='fu'>::</span><span class='fu'><a href='http://xml2.r-lib.org/reference/xml_find_all.html'>xml_find_all</a></span><span class='op'>(</span><span class='st'>"//pubDate"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_text</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>enframe</span><span class='op'>(</span><span class='va'>.</span>, 
          name<span class='op'>=</span><span class='st'>"id"</span>,
          value<span class='op'>=</span><span class='st'>"date"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>date<span class='op'>=</span><span class='va'>date</span> <span class='op'>%&gt;%</span> <span class='fu'>str_squish</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>dmy_hms</a></span><span class='op'>(</span><span class='va'>.</span>, tz<span class='op'>=</span><span class='st'>"Europe/Vienna"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#combine to one dataframe</span>
<span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span>
  <span class='va'>df_submission_pages_name</span>,
  <span class='va'>df_submission_pages_pub_date</span>,
  <span class='va'>df_submission_pages_link</span>,
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>contains</a></span><span class='op'>(</span><span class='st'>"id"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>As it turns out, there were 6,670 submissions to the amendment in total.</p>
<div class="layout-chunk" data-layout="l-body">
<p>preservec27af1992c06b789</p>
</div>
<p>Notice that there are several submissions which state ‘Keine öffentliche Stellungnahme’ (no public statement) as a name. Hence, we will not be able to analyse the text of all submissions, but only of those which are made public. How many are there? Let’s see:</p>
<details closed>
<p><summary>Code: identify public and non-public submissions</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>public<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"Keine öffentliche Stellungnahme"</span>,
                                                 ignore_case <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"not public"</span>,
                          <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='st'>"public"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>df_submission</span><span class='op'>$</span><span class='va'>public</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
not public     public 
      2885       3785 </code></pre>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
not public     public 
      2885       3785 </code></pre>
</div>
<p>Out of 6,670 submissions, the text of 3,785 is publicly available (no idea why some are published and others not, probably it’s up to the submitter to decide). While the high number of non-public submissions is obviously quite a caveat for the further analysis, we still have the text of more than 50 % of all submissions to look into.</p>
<h2 id="links-to-pdfs">Links to pdfs</h2>
<p>Now let’s use the links to the submissions’ sub-pages and search in each sub-page for a link which leads to the actual pdf document of the submission. By using the browser’s developer tools (F12 key), we can see the html code behind the page. Clicking on the link of one submission reveals that the link contains the word ‘imfname’. I use this string to identify the links to the submissions’ pdfs and neglect all other links and pdfs which are also on the site.</p>
<p><img src="submissionsepidemiclaw_files/identify_link.gif" /></p>
<p>To do so, below the function which is applied to all (!) links leading to the sub-pages with the individual submissions. It reads the html code, extracts the links (href), converts the results into a dataframe, and subsequently filters out the links which include ‘imfname’. I then complement the extracted link with the missing part of the web address (www.parlament….). Since there are several submission (sub-pages) which state that the text is not public, and don’t include a link to a pdf, I insert in these cases a ‘missing’ instead of the link. To accelerate the process I apply the function in parallel by using `furrr::future_map`.</p>
<details open>
<p><summary>Code: read html of sub-pages, extract pdf-link</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># function to identify pdf link</span>
<span class='va'>fn_get_doc_links</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span> 
  
  <span class='va'>link_doc</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>read_html</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_nodes.html'>html_nodes</a></span><span class='op'>(</span><span class='st'>"a"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rvest.tidyverse.org/reference/html_text.html'>html_attr</a></span><span class='op'>(</span><span class='st'>"href"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>enframe</span><span class='op'>(</span>name<span class='op'>=</span><span class='cn'>NULL</span>,
          value<span class='op'>=</span><span class='st'>"link_part"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>link_part</span>, <span class='st'>"imfname"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>link_doc<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"https://www.parlament.gv.at"</span>, <span class='va'>link_part</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'>pull</span><span class='op'>(</span><span class='va'>link_doc</span><span class='op'>)</span>
  <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>link_doc</span><span class='op'>)</span><span class='op'>&gt;</span><span class='fl'>0</span>, <span class='va'>link_doc</span>, <span class='st'>"missing"</span><span class='op'>)</span>
  
<span class='op'>}</span> 

<span class='co'>#apply function to all links</span>
<span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>link_doc<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map_chr</a></span><span class='op'>(</span><span class='va'>link_single_submission_page</span>, 
                          <span class='fu'>possibly</span><span class='op'>(</span><span class='va'>fn_get_doc_links</span>,
                                   otherwise<span class='op'>=</span><span class='st'>"missing"</span><span class='op'>)</span>,
                            .progress <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<h2 id="download-submissions">Download submissions</h2>
<p>Now with all pdf links available we can start to download them. To do so, I use the <code>walk2</code> function of the <code>purrr</code> package. Note that I also use <code>magrittr</code>’s <code>%$%</code>operator to expose/pipe into the the <code>walk2</code> function.</p>
<details open>
<p><summary>Code: download files</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>#define pdf's file name and download destination</span>
<span class='va'>df_submission</span><span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>file_name<span class='op'>=</span><span class='fu'>str_extract</span><span class='op'>(</span><span class='va'>link_doc</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"\\d+.pdf"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>pdf_destination<span class='op'>=</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"{here::here('blog_data','epidemic_law_submissions','pdf_files')}/{file_name}"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
           <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
           <span class='fu'>str_trim</span><span class='op'>(</span><span class='va'>.</span>, side<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"both"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#download</span>
<span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>link_doc</span><span class='op'>!=</span><span class='st'>"missing"</span><span class='op'>)</span> <span class='op'>%$%</span> <span class='co'>#exposes names</span>
  <span class='fu'>walk2</span><span class='op'>(</span>
    <span class='va'>link_doc</span>,
    <span class='va'>pdf_destination</span>,
    <span class='va'>download.file</span>, 
    mode <span class='op'>=</span> <span class='st'>"wb"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>After the steps above we now have the all the available submission files at our disposal. Finally time to start working on the actual texts.</p>
<h2 id="extract-text-from-pdfs">Extract text from pdfs</h2>
<p>When it comes to extracting text by means of OCR, <code>pdftools</code> by Jeroen Ooms is the package of choice. In preparation, we need to get the German language data. Extracting text from pdfs can be quite a time consuming matter. Going through the more than 3700 submissions initially took me more than 7 hours. Reducing the dpi value from 300 to 150 accelerated the procedure quite considerably, down to approx. 60 minutes, and I didn’t notice any relevant decrease of the output’s quality.</p>
<details open>
<p><summary>Code: extract text from pdfs</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'>tesseract</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/tesseract/reference/tessdata.html'>tesseract_download</a></span><span class='op'>(</span>lang <span class='op'>=</span> <span class='st'>"deu"</span><span class='op'>)</span>
<span class='fu'>tesseract_info</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
   <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>pdf_destination</span>, <span class='fu'>possibly</span><span class='op'>(</span><span class='op'>~</span><span class='fu'>pdftools</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/pdftools/reference/pdf_ocr.html'>pdf_ocr_text</a></span><span class='op'>(</span><span class='va'>.</span>,
                                                                      language <span class='op'>=</span> <span class='st'>"deu"</span>,
                                                                      dpi<span class='op'>=</span><span class='fl'>150</span><span class='op'>)</span>,
                                              otherwise<span class='op'>=</span><span class='st'>"missing"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>Let’s clean up the imported text, i.e. collapse multi-page submissions into one single string text, remove leading and trailing white space etc.</p>
<details open>
<p><summary>Code: clean text</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>date<span class='op'>=</span><span class='va'>date</span> <span class='op'>%&gt;%</span> 
           <span class='fu'>str_squish</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
           <span class='fu'>str_trim</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
           <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>dmy_hms</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>map_chr</span><span class='op'>(</span><span class='va'>doc_text</span>, <span class='va'>paste</span>, collapse<span class='op'>=</span><span class='st'>" "</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#collapse multipage docs</span>
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>str_squish</span><span class='op'>(</span><span class='va'>doc_text</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_trim.html'>str_trim</a></span><span class='op'>(</span><span class='va'>doc_text</span>, side<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"both"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>name_first<span class='op'>=</span><span class='fu'>str_extract</span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"(?&lt;=,\\s)[:alpha:]*(?=($|[^:alpha:]|\\s))"</span><span class='op'>)</span><span class='op'>)</span>, 
         .after<span class='op'>=</span><span class='st'>"name"</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
</details>
<p>Let’s pause for a moment and take stock: There are 6,623 submissions, out of which 3,762 are public. From the latter we were able to extract 3,750. Hence, 12 texts could not be retrieved.</p>
<h1 id="analysis">Analysis</h1>
<h2 id="identify-submissions-with-key-formulation">Identify submissions with key formulation</h2>
<p>Now with submissions’ texts cleaned etc, let’s identify those which contain the formulation which appeared quite frequently when randomly browsing through some of the texts: <em>Tür und Tor</em>.</p>
<details open>
<p><summary>Code: identify submission containing key phrase</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>submission_pattern</span> <span class='op'>&lt;-</span> <span class='st'>"Tür und Tor"</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>pattern_indicator<span class='op'>=</span><span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>doc_text</span>,
                                                <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span>pattern<span class='op'>=</span><span class='va'>submission_pattern</span>,
                                                      dotall<span class='op'>=</span><span class='cn'>T</span>,
                                                      ignore_case<span class='op'>=</span><span class='cn'>T</span>,
                                                      multiline<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>overall_indicator<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>public</span><span class='op'>==</span><span class='st'>"not public"</span> <span class='op'>~</span> <span class='st'>"not public"</span>,
      <span class='va'>pattern_indicator</span><span class='op'>==</span><span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'>str_trunc</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fl'>15</span><span class='op'>)</span>,
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='st'>"other"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_length<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/nchar.html'>nchar</a></span><span class='op'>(</span><span class='va'>doc_text</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<details closed>
<p><summary>Code: table with identified texts</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>tb_text</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/reactable.html'>reactable</a></span><span class='op'>(</span><span class='va'>df_submission</span> <span class='op'>%&gt;%</span>
            <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pattern_indicator</span><span class='op'>==</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
            <span class='fu'>select</span><span class='op'>(</span><span class='va'>name</span>, <span class='va'>date</span>, <span class='va'>doc_text</span><span class='op'>)</span>,
          defaultPageSize <span class='op'>=</span> <span class='fl'>4</span>, 
          filterable <span class='op'>=</span> <span class='cn'>TRUE</span>,
          style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>fontSize <span class='op'>=</span> <span class='st'>"10px"</span><span class='op'>)</span>,
          columns<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
            name<span class='op'>=</span><span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>width<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>,
            date<span class='op'>=</span><span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>width<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>,
            doc_text<span class='op'>=</span><span class='fu'><a href='https://glin.github.io/reactable/reference/colDef.html'>colDef</a></span><span class='op'>(</span>minWidth<span class='op'>=</span><span class='fl'>200</span><span class='op'>)</span><span class='op'>)</span>,
          bordered<span class='op'>=</span><span class='cn'>TRUE</span>,
          compact <span class='op'>=</span> <span class='cn'>TRUE</span>,
          theme <span class='op'>=</span> <span class='fu'><a href='https://glin.github.io/reactable/reference/reactableTheme.html'>reactableTheme</a></span><span class='op'>(</span>
            backgroundColor <span class='op'>=</span> <span class='st'>"#f0eff0"</span>,
                filterInputStyle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                  color<span class='op'>=</span><span class='st'>"green"</span>,backgroundColor <span class='op'>=</span> <span class='st'>"#f0eff0"</span><span class='op'>)</span>
          <span class='op'>)</span>
          <span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p>preserve03617e86f755d03a</p>
</div>
<h2 id="frequency-of-key-formulation">Frequency of key formulation</h2>
<details closed>
<p><summary>Code: table</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># table -------------------------------------------------------------------</span>
<span class='va'>df_tb_submission_1</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>n_abs<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>n_rel<span class='op'>=</span><span class='va'>n_abs</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>indicator_tbl<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>==</span><span class='st'>"not public"</span> <span class='op'>~</span> <span class='st'>"Keine öffentliche Stellungnahmen"</span>,
                                 <span class='va'>overall_indicator</span><span class='op'>==</span><span class='fu'>str_trunc</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fl'>15</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"enthalten Formulierung '{submission_pattern}'"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='op'>)</span>,
                                 <span class='va'>overall_indicator</span><span class='op'>==</span><span class='st'>"other"</span> <span class='op'>~</span> <span class='st'>"andere öffentliche Stellungnahmen"</span><span class='op'>)</span>,
         .before<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>overall_indicator</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_tb_submission_2</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>!=</span><span class='st'>"not public"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>n_abs<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>n_rel<span class='op'>=</span><span class='va'>n_abs</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>indicator_tbl<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>==</span><span class='st'>"not public"</span> <span class='op'>~</span> <span class='st'>"Keine öffentliche Stellungnahmen"</span>,
                                 <span class='va'>overall_indicator</span><span class='op'>==</span><span class='fu'>str_trunc</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fl'>15</span><span class='op'>)</span> <span class='op'>~</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"enthalten Formulierung '{submission_pattern}'"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='op'>)</span>,
                                 <span class='va'>overall_indicator</span><span class='op'>==</span><span class='st'>"other"</span> <span class='op'>~</span> <span class='st'>"andere öffentliche Stellungnahmen"</span><span class='op'>)</span>,
         .before<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>overall_indicator</span>, <span class='op'>-</span><span class='va'>n_abs</span>, n_rel_public<span class='op'>=</span><span class='va'>n_rel</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_tb_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_tb_submission_1</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>df_tb_submission_2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>tb_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_tb_submission</span> <span class='op'>%&gt;%</span>   
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/gt.html'>gt</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_header.html'>tab_header</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/gt/man/md.html'>md</a></span><span class='op'>(</span><span class='st'>"**Stellungnahmen zur Novelle des Epidemiegesetzes**"</span><span class='op'>)</span>,
    subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/gt/man/md.html'>md</a></span><span class='op'>(</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/gt/man/md.html'>md</a></span><span class='op'>(</span><span class='st'>" Von den {df_tb_submission %&gt;% filter(!str_detect(indicator_tbl, 'Keine')) %&gt;% summarise(n_abs=sum(n_abs)) %&gt;% pull(n_abs) %&gt;% scales::comma()} Stellungnahmen von denen der Text öffentlich ist enthalten rund {df_tb_submission %&gt;% filter(str_detect(indicator_tbl, 'Formulierung')) %&gt;% pull(n_rel_public) %&gt;% scales::percent()} die Formulierung *'{submission_pattern}'*."</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_options.html'>tab_options</a></span><span class='op'>(</span>heading.align <span class='op'>=</span> <span class='st'>"left"</span>,
              row_group.font.weight <span class='op'>=</span> <span class='st'>"bold"</span>,
              table.background.color<span class='op'>=</span><span class='va'>plot_bg_color</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
   <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_style.html'>tab_style</a></span><span class='op'>(</span>
    style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cell_fill.html'>cell_fill</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"orange"</span><span class='op'>)</span>,
      <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cell_text.html'>cell_text</a></span><span class='op'>(</span>weight <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>
      <span class='op'>)</span>,
    locations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cells_body.html'>cells_body</a></span><span class='op'>(</span>
      columns <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span>,
      rows <span class='op'>=</span> <span class='va'>n_abs</span> <span class='op'>==</span> <span class='fl'>2204</span><span class='op'>)</span> 
    <span class='op'>)</span><span class='op'>%&gt;%</span> 
    <span class='co'>#  tab_style(</span>
    <span class='co'># style = list(</span>
    <span class='co'>#   cell_fill(color = "orange"),</span>
    <span class='co'>#   cell_text(weight = "bold")</span>
    <span class='co'>#   ),</span>
    <span class='co'># locations = cells_body(</span>
    <span class='co'>#   columns = vars(n_rel),</span>
    <span class='co'>#   rows = n_rel &gt; 0.32 &amp; n_rel &lt; .34) </span>
    <span class='co'># )%&gt;% </span>
       <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_style.html'>tab_style</a></span><span class='op'>(</span>
        style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
          <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cell_fill.html'>cell_fill</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"orange"</span><span class='op'>)</span>,
          <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cell_text.html'>cell_text</a></span><span class='op'>(</span>weight <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span>
        <span class='op'>)</span>,
        locations <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cells_body.html'>cells_body</a></span><span class='op'>(</span>
        columns <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>n_abs</span>, <span class='va'>n_rel</span>, <span class='va'>n_rel_public</span><span class='op'>)</span>,
        rows <span class='op'>=</span> <span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>indicator_tbl</span>, <span class='st'>"Formulierung"</span><span class='op'>)</span><span class='op'>)</span> 
    <span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/cols_label.html'>cols_label</a></span><span class='op'>(</span>indicator_tbl<span class='op'>=</span><span class='st'>"Stellungnahme"</span>,
             n_abs<span class='op'>=</span><span class='st'>"Anzahl"</span>,
             n_rel<span class='op'>=</span><span class='st'>"Anteil alle St."</span>,
             n_rel_public<span class='op'>=</span><span class='st'>"Anteil öff. St."</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/fmt_missing.html'>fmt_missing</a></span><span class='op'>(</span>columns<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>n_rel_public</span><span class='op'>)</span>, missing_text <span class='op'>=</span> <span class='st'>"--"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/fmt_number.html'>fmt_number</a></span><span class='op'>(</span>columns<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>n_abs</span><span class='op'>)</span>, decimals<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/fmt_percent.html'>fmt_percent</a></span><span class='op'>(</span>columns <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>n_rel</span>, <span class='va'>n_rel_public</span><span class='op'>)</span>, decimals <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/gt/man/tab_source_note.html'>tab_source_note</a></span><span class='op'>(</span>source_note <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/gt/man/md.html'>md</a></span><span class='op'>(</span><span class='st'>"data: www.parlament.gv.at, 'Ministerialentwurf betreffend Bundesgesetz, mit dem das Epidemiegesetz 1950, das Tuberkulosegesetz und das COVID-19-Maßnahmengesetz geändert werden.'&lt;br&gt;analysis: Roland Schmidt | @zoowalk | https://werk.statt.codes"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>As the table below shows, in 2,341 submissions the formulation ‘<em>Tür und Tor</em>’ appears. <em>This number amounts to 35% of all submissions, and to 62% of all submissions for which we can access the text.</em> I think that’s quite remarkable in the sense that it is suggest for quite pervasive use of a submission template.</p>
<div class="layout-chunk" data-layout="l-body">
<p>preserve7753fd4838a9d122</p>
</div>
<h2 id="distribution-of-length">Distribution of length</h2>
<p>Let’s approach the similarity of submissions from another angle now: The length of the text. The graph below shows the distribution of submissions’ length in terms of number of characters. One density curve shows the distribution for submissions which include the key phrase ‘Tür und Tor’, the other one shows the distribution of those which don’t include it (and for which the text is available).</p>
<details closed>
<p><summary>Code: distribution of length</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># distribution of length --------------------------------------------------</span>

<span class='va'>my_caption</span> <span class='op'>&lt;-</span> <span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"data: www.parlament.gv.at; Stellungnahmen zum Ministerialentwurf betreffend Bundesgesetz, mit dem das Epidemiegesetz 1950, das Tuberkulosegesetz \nund das COVID-19-Maßnahmengesetz geändert werden.\nanalysis: Roland Schmidt | @zoowalk | https://werk.statt.codes"</span><span class='op'>)</span>

<span class='va'>pl_length</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>public</span><span class='op'>!=</span><span class='st'>"not public"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>doc_length</span><span class='op'>&lt;</span><span class='fl'>1000</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#remove outliers</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>pattern_indicator</span>,
             x<span class='op'>=</span><span class='va'>doc_length</span>,
             fill<span class='op'>=</span><span class='va'>pattern_indicator</span>,
             color<span class='op'>=</span><span class='va'>pattern_indicator</span><span class='op'>)</span>
         <span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"BEGUTACHTUNGSVERFAHREN EPIDEMIEGESETZ-NOVELLE:&lt;br&gt;"</span>,<span class='st'>"Verteilung der Länge von Stellungnahmen mit u. ohne Formulierung "</span>,<span class='st'>"'"</span>,<span class='fu'>str_trunc</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fl'>20</span><span class='op'>)</span>,<span class='st'>"'"</span><span class='op'>)</span>,
       subtitle<span class='op'>=</span><span class='st'>"Zur besseren Sichtbarkeit wurden Stellungnahmen mit mehr als 1000 Zeichen ausgeschlossen."</span>,
       x<span class='op'>=</span><span class='st'>"Länge Stellungnahme in Zeichen"</span>,
       caption<span class='op'>=</span><span class='va'>my_caption</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggridges</span><span class='fu'>::</span><span class='fu'><a href='https://wilkelab.org/ggridges/reference/geom_density_ridges.html'>geom_density_ridges</a></span><span class='op'>(</span>scale<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"FALSE"</span><span class='op'>=</span><span class='st'>"darkolivegreen4"</span>,
                                   <span class='st'>"TRUE"</span><span class='op'>=</span><span class='st'>"orange"</span><span class='op'>)</span>,
                    labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"FALSE"</span><span class='op'>=</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"ohne '{str_trunc(submission_pattern, 20)}'"</span><span class='op'>)</span>,
                             <span class='st'>"TRUE"</span><span class='op'>=</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"mit '{str_trunc(submission_pattern, 20)}'"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_color_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"FALSE"</span><span class='op'>=</span><span class='st'>"darkolivegreen4"</span>,
                             <span class='st'>"TRUE"</span><span class='op'>=</span><span class='st'>"orange"</span><span class='op'>)</span>,
                     labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"FALSE"</span><span class='op'>=</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"ohne '{str_trunc(submission_pattern, 20)}'"</span><span class='op'>)</span>,
                             <span class='st'>"TRUE"</span><span class='op'>=</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"mit '{str_trunc(submission_pattern, 20)}'"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_discrete</span><span class='op'>(</span>expand<span class='op'>=</span><span class='fu'>expansion</span><span class='op'>(</span>mult<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_post</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>
    plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
    panel.grid.minor.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    panel.grid.major.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    panel.grid.minor.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    plot.caption <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>,
    legend.position <span class='op'>=</span> <span class='st'>"top"</span>,
    legend.justification <span class='op'>=</span> <span class='st'>"left"</span>,
   legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,
    legend.title<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    axis.title.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    axis.text.y<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>guides</span><span class='op'>(</span>fill<span class='op'>=</span><span class='fu'>guide_legend</span><span class='op'>(</span>reverse<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span>,
         color<span class='op'>=</span><span class='fu'>guide_legend</span><span class='op'>(</span>reverse<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-28-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p>What the graph shows is that the length of submissions which contain the formulation ‘Tür und Tor’ is concentrated at around 350 characters, while the length of other submissions is more dispersed. Hence, when it comes to the length of documents, those containing the distinct formulation are also pretty similar in term of their length. I take this as another indicator for the similarity of the submissions with our search phrase. As for the density curve of those not containing the search phrase, note that there is still a little ‘bump’ around 350. This could potentially reflect that we are missing out on some submissions which may originate from the same submission template, but do not include the exact wording of our search phrase.</p>
<h2 id="submissions-over-time">Submissions over time</h2>
<p>I was also wondering whether there is any ‘temporal’ pattern as to the date of the submission. If the submissions were the result of a social media campaign, are the timings of their submissions clustered? This could be read as a reaction to e.g. a social media post providing a template and asking to submit it.</p>
<details closed>
<p><summary>Code: submissions per day</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># bar graph ---------------------------------------------------------------</span>

<span class='va'>df_submission_pattern</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>overall_indicator<span class='op'>=</span><span class='fu'>fct_infreq</span><span class='op'>(</span><span class='va'>overall_indicator</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>overall_indicator</span>, .drop<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>n<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>date<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>df_submission_pattern</span><span class='op'>$</span><span class='va'>overall_indicator</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;not public&quot;  &quot;Tür und Tor&quot; &quot;other&quot;      </code></pre>
<div class="sourceCode">
<pre><code><span class='va'>label_submission_pattern</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"Enthält '{str_trunc(submission_pattern,15)}'"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>colors_indicators</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey70"</span>, <span class='st'>"orange"</span>, <span class='st'>"darkolivegreen4"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>colors_indicators</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"not public"</span>, <span class='fu'>str_trunc</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fl'>15</span><span class='op'>)</span>, <span class='st'>"other"</span><span class='op'>)</span>

<span class='va'>pl_submission_pattern</span> <span class='op'>&lt;-</span> <span class='va'>df_submission_pattern</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>date</span><span class='op'>&lt;=</span><span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='st'>"2020-09-19"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"BEGUTACHTUNGSVERFAHREN EPIDEMIEGESETZ-NOVELLE:&lt;br&gt;"</span>,<span class='st'>"Zeitpunkt der Einrechung der Stellungnahmen, mit u. ohne Formulierung"</span><span class='op'>)</span>,
       subtitle<span class='op'>=</span><span class='st'>""</span>,
       caption<span class='op'>=</span><span class='va'>my_caption</span>,
       x<span class='op'>=</span><span class='st'>"Datum"</span>,
       y<span class='op'>=</span><span class='st'>"Anzahl Einreichungen"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>date</span>,
               y<span class='op'>=</span><span class='va'>n</span>,
               fill<span class='op'>=</span><span class='va'>overall_indicator</span><span class='op'>)</span>,
           position<span class='op'>=</span><span class='fu'>position_dodge2</span><span class='op'>(</span><span class='op'>)</span>,
           color<span class='op'>=</span><span class='cn'>NA</span>,
           stat<span class='op'>=</span><span class='st'>"identity"</span>,
           key_glyph <span class='op'>=</span> <span class='st'>"dotplot"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_x_date</span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_date.html'>label_date_short</a></span><span class='op'>(</span><span class='op'>)</span>,
               date_breaks<span class='op'>=</span><span class='st'>"1 days"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>expand<span class='op'>=</span><span class='fu'>expansion</span><span class='op'>(</span>mult<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>,
                     labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_number.html'>label_comma</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='va'>colors_indicators</span>,
                    labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"not public"</span><span class='op'>=</span><span class='st'>"keine öffentliche Stellungnahme"</span>,
                             submission_pattern<span class='op'>=</span><span class='va'>label_submission_pattern</span>,
                                  <span class='st'>"other"</span><span class='op'>=</span><span class='st'>"andere öffentliche Stellungnahmen"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_post</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>
    plot.title.position <span class='op'>=</span> <span class='st'>"panel"</span>,
    plot.subtitle <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    panel.grid.minor.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    panel.grid.major.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    panel.grid.minor.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    plot.caption <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>,
    legend.position <span class='op'>=</span> <span class='st'>"top"</span>,
    legend.box.margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>l<span class='op'>=</span><span class='fl'>0</span>, unit<span class='op'>=</span><span class='st'>"cm"</span><span class='op'>)</span>,
    legend.margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>l<span class='op'>=</span><span class='fl'>0</span>, unit<span class='op'>=</span><span class='st'>"cm"</span><span class='op'>)</span>,
    legend.key.size <span class='op'>=</span> <span class='fu'>unit</span><span class='op'>(</span><span class='fl'>1</span>, units<span class='op'>=</span><span class='st'>"cm"</span><span class='op'>)</span>,
    legend.justification <span class='op'>=</span> <span class='st'>"left"</span>,
    legend.title<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
    axis.title.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>guides</span><span class='op'>(</span>fill<span class='op'>=</span><span class='fu'>guide_legend</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-30-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p>I think the bar chart above doesn’t suggest any temporal clustering of submissions including ‘Tür und Tor’. But considering that the speed with which the amendment was introduced and the very short period to file submissions doesn’t really allow for much clustering.</p>
<h1 id="analysis-with-quanteda">Analysis with ‘quanteda’</h1>
<p>As already indicated in the introduction, the above analysis - while informative to some extent - has its limitations. Limiting the search to the presence/absence of the key phrase ‘Tür und Tor’ is prone to miss out on other wordings which might be even more prevalent in some of the submissions. Furthermore, only marginal changes to the wording could result in the omission of submissions which are otherwise very similar.</p>
<p>To overcome these limitations and approach the issue of text similarity in a methodologically more rigors manner, let’s now take up some of the features of the <code>quanteda</code> package. I never worked with the package before but from what I can tell it provides a very comprehensive and powerful set of tools for quantitative text analysis (for an overview see <a href="https://quanteda.io/articles/pkgdown/comparison.html" target="_blank">here</a>).</p>
<p>To be able to use the offered tools, we have to convert our collection of submission texts into a ‘corpus’. Before doing so, I further clean the extracted texts so that we only have the actual text of the submission and not any header, footer, or meta-data. Then let’s create a <code>corpus</code>.</p>
<details open>
<p><summary>Code: Clean text, create corpus</summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://quanteda.io'>quanteda</a></span><span class='op'>)</span>
<span class='va'>df_submission_quanteda</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>doc_text</span><span class='op'>!=</span><span class='st'>"missing"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>file_name</span>, <span class='va'>doc_text</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>str_remove</span><span class='op'>(</span><span class='va'>doc_text</span>,<span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"^.*Eingebracht am: \\d{2}\\.\\d{2}\\.\\d{4}\\s*"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>str_remove</span><span class='op'>(</span><span class='va'>doc_text</span>,<span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"\\s?www.parlament.gv.at\\s*$"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='fu'>str_remove</span><span class='op'>(</span><span class='va'>doc_text</span>,<span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"^.?Betr\\.?\\:?\\s?Änderung(en)? des Ep(i|e)demie Gesetzes\\.?"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>doc_text<span class='op'>=</span><span class='va'>doc_text</span> <span class='op'>%&gt;%</span> <span class='fu'>str_squish</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>str_trim</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>#create vector</span>
<span class='va'>vec_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission_quanteda</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>deframe</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>#create corpus</span>
<span class='va'>corp_submission</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/corpus.html'>corpus</a></span><span class='op'>(</span><span class='va'>vec_submission</span>, docvars<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>submission<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vec_submission</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>The corpus is essentially a named vector with the names of the sumbission files the names of the vector’s elements.</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>Corpus consisting of 6 documents and 1 docvar.
835051.pdf :
&quot;Sehr geehrte Damen und Herren! Gegen den Gesetzesentwurf des...&quot;

833930.pdf :
&quot;Ich erhebe schärfste Einwendungen gegen diesen Gesetzesentwu...&quot;

833003.pdf :
&quot;Keine Stellungnahme&quot;

831523.pdf :
&quot;Ich erhebe schärfste Einwendungen gegen diesen Gesetzesentwu...&quot;

830585.pdf :
&quot;Ich kann den vorgesehenen Änderungen nicht zustimmen, da wir...&quot;

829581.pdf :
&quot;Ich weigere mich massiv gegen diese Gesetzesänderung da dies...&quot;</code></pre>
</div>
<h2 id="collocations">Collocations</h2>
<p>With this as the basis, we can now identify all collocations e.g. which comprise 3 words as e.g. in ‘Tür und Tor’. The <code>textstat_collocation</code> function provides us with the frequencies for all (!) collocations of the requested length. For performance reasons I limited the results to those collocations which result in more than 500 hits. For a detailed description of the function see <a href="https://quanteda.io/reference/textstat_collocations.html" target="_blank">here</a>.</p>
<details open>
<p><summary>Code: Get collocations </summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>#collocations</span>

<span class='va'>n_words</span> <span class='op'>&lt;-</span> <span class='fu'>str_count</span><span class='op'>(</span><span class='va'>submission_pattern</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='st'>"\\S+"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>n_words</span>
</code></pre>
</div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>collocs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/textstat_collocations.html'>textstat_collocations</a></span><span class='op'>(</span>
  <span class='va'>corp_submission</span>,
  method <span class='op'>=</span> <span class='st'>"lambda"</span>,
  size <span class='op'>=</span> <span class='va'>n_words</span>,
  min_count <span class='op'>=</span> <span class='fl'>500</span>,
  smoothing <span class='op'>=</span> <span class='fl'>0.5</span>,
  tolower <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>df_collocs</span> <span class='op'>&lt;-</span> <span class='va'>collocs</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>as_tibble</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>And as it turns out, our used inductively selected key phrase ‘Tür und Tor’ is close to the most frequent one. The collocation ‘gegen diesen gesetzesentwurf’ appears 2,372.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<p>preserve8dbe1ad8b0100e7f</p>
</div>
<h2 id="cosine-similarity">Cosine similarity</h2>
<p>Quantitative text analysis offers also the concept of <strong>cosine similarity</strong> when it comes to evaluating the similarity of two or more documents. I won’t dig into the details here, but want to refer you to the video below which provides in my view a clear and accessible overview.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/5lvS8078ykA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><br></p>
<p>One of the convenient properties of the concept is that it allows us to compare documents of any lengths along a scale of 0 (not similar at all) to 1 (identical).</p>
<p>In order to control for different document length when it comes to check for similarity, we have to create a weighted document feature matrix which accounts for the relative frequency of words (see <a href="https://quanteda.io/reference/dfm_weight.html?q=dfm%20_%20weight" target="_blank">here</a>).</p>
<details open>
<p><summary>Code: create document feature matrix (dfm) </summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>#create document-feature matrix</span>

<span class='va'>vec_submission_wo_pattern</span> <span class='op'>&lt;-</span> <span class='fu'>map_chr</span><span class='op'>(</span><span class='va'>vec_submission</span>, <span class='op'>~</span><span class='fu'>str_remove_all</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>submission_pattern</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>corp_submission_wo_term</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/corpus.html'>corpus</a></span><span class='op'>(</span><span class='va'>vec_submission_wo_pattern</span>, docvars<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>submission<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vec_submission_wo_pattern</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>dfmat_submission</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm.html'>dfm</a></span><span class='op'>(</span><span class='va'>corp_submission_wo_term</span>, 
                        remove <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/stopwords/man/stopwords.html'>stopwords</a></span><span class='op'>(</span><span class='st'>"de"</span><span class='op'>)</span>,
                        stem <span class='op'>=</span> <span class='cn'>TRUE</span>, 
                        remove_punct <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>dfmat_prop_submission</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm_weight.html'>dfm_weight</a></span><span class='op'>(</span><span class='va'>dfmat_submission</span>,
                                    scheme<span class='op'>=</span><span class='st'>"prop"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<p>With this we can calculate the cosine similarity of texts.</p>
<details open>
<p><summary>Code: create similarity matrix (dfm) </summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>#create similarity matrix</span>
<span class='va'>mat_similarity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/textstat_simil.html'>textstat_simil</a></span><span class='op'>(</span><span class='va'>dfmat_prop_submission</span>, <span class='va'>dfmat_prop_submission</span>, 
                            margin <span class='op'>=</span> <span class='st'>"documents"</span>, 
                            method <span class='op'>=</span> <span class='st'>"cosine"</span><span class='op'>)</span>

<span class='co'>#convert to dataframe</span>
<span class='va'>df_similarity</span> <span class='op'>&lt;-</span> <span class='va'>mat_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>.</span>, 
                upper<span class='op'>=</span><span class='cn'>FALSE</span>,
                diag<span class='op'>=</span><span class='cn'>FALSE</span>,
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>sim_interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>cosine</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>.1</span><span class='op'>)</span><span class='op'>)</span>,
                          right<span class='op'>=</span><span class='cn'>F</span>,
                          include.lowest<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<h3 id="document-pairwise-comparison">Document pairwise comparison</h3>
<p>What we obtain now is a comparison of all submission pairs (!) as to their cosine similarity. Overall, these are 11,772,506 pairs (duplicates removed, i.e. document 1 vs document 2 = document 2 vs document 1). Seems like text analysis can quickly get a bit large. To keep the table manageable I only show the first thousand.</p>
<div class="layout-chunk" data-layout="l-body">
<p>preserve57e98e4ff90b7c1f</p>
</div>
<p>To be able to group these pairs according to their similarity, I cut their cosine similarity values into 10 intervals (<code>sim_interval</code>). We can now count the number of submission pairs per interval. The barplot below presents the relative result, i.e. the share of submission pairs from the total number of pairs.</p>
<details closed>
<p><summary>Code: Frequency of pairs per cosine interval </summary></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_similarity</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>select</span><span class='op'>(</span><span class='va'>file_name</span>, <span class='va'>pattern_indicator</span><span class='op'>)</span>,
            by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"document1"</span><span class='op'>=</span><span class='st'>"file_name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>document1_indicator<span class='op'>=</span><span class='va'>pattern_indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>.</span>, <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>select</span><span class='op'>(</span><span class='va'>file_name</span>, <span class='va'>pattern_indicator</span><span class='op'>)</span>,
            by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"document2"</span><span class='op'>=</span><span class='st'>"file_name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>document2_indicator<span class='op'>=</span><span class='va'>pattern_indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>indicator<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span><span class='va'>document1_indicator</span><span class='op'>==</span><span class='cn'>T</span> <span class='op'>&amp;</span> <span class='va'>document2_indicator</span><span class='op'>==</span><span class='cn'>T</span> <span class='op'>~</span> <span class='st'>"both submissions with key phrase"</span>,
                             <span class='va'>document1_indicator</span><span class='op'>==</span><span class='cn'>F</span> <span class='op'>&amp;</span> 
                               <span class='va'>document2_indicator</span><span class='op'>==</span><span class='cn'>F</span> <span class='op'>~</span> <span class='st'>"both submissions without key phrase"</span>,
                             <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='st'>"one submission without key phrase"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>vec_color_submissions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#FFC125"</span>, <span class='st'>"#104E8B"</span>, <span class='st'>"grey50"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vec_color_submissions</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"both submissions with key phrase"</span>,
<span class='st'>"one submission without key phrase"</span>,
<span class='st'>"both submissions without key phrase"</span><span class='op'>)</span>

<span class='co'>#barplot</span>
<span class='va'>df_bar_sim</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>sim_interval</span>, <span class='va'>indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>interval_n<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>interval_rel<span class='op'>=</span><span class='va'>interval_n</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>interval_n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>law<span class='op'>=</span><span class='st'>"EpidemieG"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>indicator<span class='op'>=</span><span class='fu'>fct_relevel</span><span class='op'>(</span><span class='va'>indicator</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vec_color_submissions</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>pl_bar_sim</span> <span class='op'>&lt;-</span> <span class='va'>df_bar_sim</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    title<span class='op'>=</span><span class='st'>"PUBLIC CONSULTATION PROCEDURE ON EPIDEMIC LAW:&lt;br&gt;
    Distribution of all submission pairs' cosine similarity"</span>,
    subtitle<span class='op'>=</span><span class='st'>""</span>,
    y<span class='op'>=</span><span class='st'>"% of all submission pairs"</span>,
    x<span class='op'>=</span><span class='st'>"cosine similarity"</span>,
    caption<span class='op'>=</span><span class='va'>my_caption</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
               y<span class='op'>=</span><span class='va'>interval_rel</span>,
               fill<span class='op'>=</span><span class='va'>indicator</span><span class='op'>)</span>,
           position<span class='op'>=</span><span class='fu'>position_stack</span><span class='op'>(</span><span class='op'>)</span>,
           stat<span class='op'>=</span><span class='st'>"identity"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>
    <span class='co'># data=. %&gt;%</span>
    <span class='co'>#           filter(sim_interval %in% c("[0.7,0.8)", "[0.8,0.9)", "[0.9,1]")) %&gt;%</span>
    <span class='co'>#                    filter(str_detect(indicator, "both submissions with key phrase")),</span>
data<span class='op'>=</span><span class='va'>.</span> <span class='op'>%&gt;%</span>  <span class='fu'>mutate</span><span class='op'>(</span>interval_rel_label<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span>
                                                <span class='va'>indicator</span><span class='op'>==</span><span class='st'>"both submissions without key phrase"</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>,
  <span class='va'>interval_rel</span><span class='op'>&gt;</span><span class='fl'>0.05</span> <span class='op'>~</span> <span class='va'>interval_rel</span>,
                                                <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='cn'>NA_real_</span><span class='op'>)</span><span class='op'>)</span>,
    <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
    y<span class='op'>=</span><span class='va'>interval_rel</span>,
    label<span class='op'>=</span><span class='va'>interval_rel_label</span> <span class='op'>%&gt;%</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_percent.html'>percent</a></span><span class='op'>(</span><span class='va'>.</span>, accuracy <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>,
    group<span class='op'>=</span><span class='va'>indicator</span><span class='op'>)</span>,
position<span class='op'>=</span><span class='fu'>position_stack</span><span class='op'>(</span>vjust<span class='op'>=</span><span class='fl'>0.5</span>, reverse <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>,
color<span class='op'>=</span><span class='st'>"white"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'># stat_summary(fun.y = sum, </span>
  <span class='co'>#              aes(x=sim_interval,</span>
  <span class='co'>#                  y=interval_rel+.1,</span>
  <span class='co'>#                  label = ..y.. %&gt;% scales::percent(., accuracy = 0.01), </span>
  <span class='co'>#                  group = sim_interval), </span>
  <span class='co'>#              # position=position_stack(),</span>
  <span class='co'>#              # vjust=2,</span>
  <span class='co'>#              geom = "text")+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>
    <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
        y<span class='op'>=</span><span class='va'>interval_rel</span>,
        label <span class='op'>=</span> <span class='va'>..y..</span> <span class='op'>%&gt;%</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_percent.html'>percent</a></span><span class='op'>(</span><span class='va'>.</span>, accuracy <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>,
        group <span class='op'>=</span> <span class='va'>sim_interval</span><span class='op'>)</span>, 
    stat <span class='op'>=</span> <span class='st'>'summary'</span>, 
    fun <span class='op'>=</span> <span class='va'>sum</span>, 
    vjust <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>
  <span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                     expand<span class='op'>=</span><span class='fu'>expansion</span><span class='op'>(</span>mult<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='va'>vec_color_submissions</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_post</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>,
                                    size<span class='op'>=</span><span class='fl'>9</span>,
                                    color<span class='op'>=</span><span class='st'>"grey50"</span>,
                                    hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
        legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,
        legend.position<span class='op'>=</span><span class='st'>"top"</span>,
        plot.subtitle <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        plot.title<span class='op'>=</span><span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>margin<span class='op'>=</span><span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,
        legend.title<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        legend.text <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-39-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br> If we take 0.7 as a cut-off point, we can conclude that 27.71% of all submission pairs (!) were very similar. Note that among these submission pairs, there is no pair in which not at least one document contains our key phrase <em>‘Tür und Tor’</em>. On the other end of the scale, we see that the largest junk of non-similar pairs (18.14% in the interval [0, 0.1)) consists of pairs of one document with the key phrase and the other document without it.</p>
<p>Note that I removed the key phrase before calculating the cosine similarity. Hence, the high degree of similarity of submission pairs containing the key phrase does not originate from the key phrase, but from the rest of the texts!</p>
<details closed>
<summary>Code: Plot composition per cosine interval </summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_bar_sim</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>sim_interval</span>, <span class='va'>indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>summarise</span><span class='op'>(</span>sum_interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>interval_rel</span>, na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>sum_indidicator_rel<span class='op'>=</span><span class='va'>sum_interval</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sum_interval</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 30 x 4
# Groups:   sim_interval [10]
   sim_interval indicator                           sum_interval
   &lt;fct&gt;        &lt;fct&gt;                                      &lt;dbl&gt;
 1 [0,0.1)      both submissions with key phrase         0.00985
 2 [0,0.1)      one submission without key phrase        0.181  
 3 [0,0.1)      both submissions without key phrase      0.0604 
 4 [0.1,0.2)    both submissions with key phrase         0.0161 
 5 [0.1,0.2)    one submission without key phrase        0.0942 
 6 [0.1,0.2)    both submissions without key phrase      0.0278 
 7 [0.2,0.3)    both submissions with key phrase         0.0232 
 8 [0.2,0.3)    one submission without key phrase        0.0415 
 9 [0.2,0.3)    both submissions without key phrase      0.00911
10 [0.3,0.4)    both submissions with key phrase         0.0285 
   sum_indidicator_rel
                 &lt;dbl&gt;
 1              0.0391
 2              0.721 
 3              0.240 
 4              0.117 
 5              0.682 
 6              0.201 
 7              0.315 
 8              0.562 
 9              0.123 
10              0.483 
# ... with 20 more rows</code></pre>
</div>
<p>Another way to approach the issue is to look into the composition of each interval. The plot below provides the pertaining overview. As it becomes quite clear, the the share of submission pairs with both documents containing our search phrase becomes higher the more similar the documents are. Again, let’s note that the detected similarity does not originate from both documents containing ‘Tür und Tor’ since I removed these words before calculating pairs’ similarity. I take plot below as another indication of the use of a submission template.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>pl_bar_sim_fill</span> <span class='op'>&lt;-</span> <span class='va'>df_bar_sim</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    title<span class='op'>=</span><span class='st'>"PUBLIC CONSULTATION PROCEDURE ON EPIDEMIC LAW:&lt;br&gt;
    Composition of submission pairs' cosine similarity intervals"</span>,
    <span class='co'># subtitle="",</span>
    y<span class='op'>=</span><span class='st'>"% of all submission pairs"</span>,
    x<span class='op'>=</span><span class='st'>"cosine similarity"</span>,
    caption<span class='op'>=</span><span class='va'>my_caption</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
               y<span class='op'>=</span><span class='va'>interval_rel</span>,
               fill<span class='op'>=</span><span class='va'>indicator</span><span class='op'>)</span>,
           position<span class='op'>=</span><span class='st'>"fill"</span>,
           stat<span class='op'>=</span><span class='st'>"identity"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'># geom_text(aes(x=sim_interval,</span>
  <span class='co'>#               y=interval_rel,</span>
  <span class='co'>#               group=indicator,</span>
  <span class='co'>#               label=interval_rel %&gt;% scales::percent(., accuracy = 0.01)),</span>
  <span class='co'>#           position=position_fill(reverse=FALSE, vjust=0.5),</span>
  <span class='co'>#           color="white")+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>.</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>sim_interval</span>, <span class='va'>indicator</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>summarise</span><span class='op'>(</span>sum_interval<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>interval_rel</span>, na.rm<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>sum_indidicator_rel<span class='op'>=</span><span class='va'>sum_interval</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sum_interval</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>mutate</span><span class='op'>(</span>sum_indidicator_rel<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span><span class='va'>sum_indidicator_rel</span><span class='op'>&lt;</span><span class='fl'>0.05</span> <span class='op'>~</span> <span class='cn'>NA_real_</span>,
                                                   <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>sum_indidicator_rel</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
            <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
                y<span class='op'>=</span><span class='va'>sum_indidicator_rel</span>,
                group<span class='op'>=</span><span class='va'>indicator</span>,
                label<span class='op'>=</span><span class='va'>sum_indidicator_rel</span> <span class='op'>%&gt;%</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_percent.html'>percent</a></span><span class='op'>(</span><span class='va'>.</span>, accuracy<span class='op'>=</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>,
            color<span class='op'>=</span><span class='st'>"white"</span>,
            position<span class='op'>=</span><span class='fu'>position_fill</span><span class='op'>(</span>vjust<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>sim_interval</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>summarise</span><span class='op'>(</span>n_obs<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
            <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sim_interval</span>,
                y<span class='op'>=</span><span class='fl'>1.1</span>,
                label<span class='op'>=</span><span class='va'>n_obs</span> <span class='op'>%&gt;%</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_number.html'>comma</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
            color<span class='op'>=</span><span class='st'>"grey40"</span>,
            stat<span class='op'>=</span><span class='st'>"identity"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>label<span class='op'>=</span><span class='st'>"number of pairs:"</span>,
            x<span class='op'>=</span><span class='fl'>.5</span>,
            y<span class='op'>=</span><span class='fl'>1.17</span>,
            color<span class='op'>=</span><span class='st'>"grey40"</span>,
            hjust<span class='op'>=</span><span class='fl'>0</span>,
            check_overlap <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>labels<span class='op'>=</span><span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org//reference/label_percent.html'>label_percent</a></span><span class='op'>(</span>accuracy<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
                     expand<span class='op'>=</span><span class='fu'>expansion</span><span class='op'>(</span>mult<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>,
                     breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='va'>vec_color_submissions</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_post</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>,
                                    size<span class='op'>=</span><span class='fl'>9</span>,
                                    color<span class='op'>=</span><span class='st'>"grey50"</span>,
                                    hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>,
        legend.position<span class='op'>=</span><span class='st'>"top"</span>,
        legend.direction <span class='op'>=</span> <span class='st'>"horizontal"</span>,
        legend.text<span class='op'>=</span><span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>9</span><span class='op'>)</span>,
        plot.subtitle <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        plot.title<span class='op'>=</span><span class='fu'><a href='https://wilkelab.org/ggtext/reference/element_markdown.html'>element_markdown</a></span><span class='op'>(</span>margin<span class='op'>=</span><span class='fu'>unit</span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='st'>"cm"</span><span class='op'>)</span><span class='op'>)</span>,
        legend.title<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-42-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<h3 id="groupwise-comparison">Groupwise comparison</h3>
<p>Finally, to further highlight the similarity of documents with Tür und Tor in contrast to other submission pairs, let’s contrast the distribution of of the cosine similarity values per group with a violin plot.</p>
<details closed>
<summary>Code: Groupwise comparison </summary>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>#create indicator for each document</span>
<span class='va'>df_submission</span> <span class='op'>&lt;-</span> <span class='va'>df_submission</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>search_term<span class='op'>=</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>doc_text</span>, <span class='fu'><a href='https://rdrr.io/r/base/regex.html'>regex</a></span><span class='op'>(</span><span class='va'>submission_pattern</span>,
                                                ignore_case <span class='op'>=</span> <span class='cn'>T</span>,
                                                multiline <span class='op'>=</span> <span class='cn'>T</span>,
                                                dotall <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 

<span class='co'>#add indicator to pairwise similarity comparison for first document</span>
<span class='va'>df_similarity</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>.</span>,
            <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>select</span><span class='op'>(</span><span class='va'>file_name</span>, <span class='va'>search_term</span><span class='op'>)</span>,
            by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"document1"</span><span class='op'>=</span><span class='st'>"file_name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>document1_term<span class='op'>=</span><span class='va'>search_term</span><span class='op'>)</span>

<span class='co'>#add indicator to pairwise similarity comparison for first document</span>
<span class='va'>df_similarity</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>.</span>,
            <span class='va'>df_submission</span> <span class='op'>%&gt;%</span> 
              <span class='fu'>select</span><span class='op'>(</span><span class='va'>file_name</span>, <span class='va'>search_term</span><span class='op'>)</span>,
            by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"document2"</span><span class='op'>=</span><span class='st'>"file_name"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>document2_term<span class='op'>=</span><span class='va'>search_term</span><span class='op'>)</span>

<span class='co'>#create one, both, none groups</span>
<span class='va'>df_similarity</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>group_id<span class='op'>=</span><span class='fu'>case_when</span><span class='op'>(</span>
    <span class='va'>document1_term</span><span class='op'>==</span><span class='cn'>TRUE</span> <span class='op'>&amp;</span> <span class='va'>document2_term</span><span class='op'>==</span><span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"both"</span>,
    <span class='va'>document1_term</span><span class='op'>==</span><span class='cn'>FALSE</span> <span class='op'>&amp;</span> <span class='va'>document2_term</span><span class='op'>==</span><span class='cn'>FALSE</span> <span class='op'>~</span> <span class='st'>"none"</span>,
    <span class='va'>document1_term</span><span class='op'>==</span><span class='cn'>TRUE</span> <span class='op'>&amp;</span> <span class='va'>document2_term</span><span class='op'>==</span><span class='cn'>FALSE</span> <span class='op'>~</span> <span class='st'>"one"</span>,
    <span class='va'>document1_term</span><span class='op'>==</span><span class='cn'>FALSE</span> <span class='op'>&amp;</span> <span class='va'>document2_term</span><span class='op'>==</span><span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"one"</span>,
    <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='st'>"missing"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>pl_sim_groups</span> <span class='op'>&lt;-</span> <span class='va'>df_similarity</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>indicator<span class='op'>=</span><span class='fu'>fct_relevel</span><span class='op'>(</span><span class='va'>indicator</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vec_color_submissions</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>
    title<span class='op'>=</span><span class='st'>"PUBLIC CONSULTATION PROCEDURE ON EPIDEMIC LAW:&lt;br&gt;Cosine similarity of submission pairs per group"</span>,
    subtitle<span class='op'>=</span><span class='fu'>str_wrap</span><span class='op'>(</span><span class='fu'>glue</span><span class='fu'>::</span><span class='fu'><a href='https://glue.tidyverse.org/reference/glue.html'>glue</a></span><span class='op'>(</span><span class='st'>"Grouped by presence/absence of key phrase '{submission_pattern}'. Key phrase was removed before calculating cosine similarity."</span><span class='op'>)</span>,<span class='fl'>110</span><span class='op'>)</span>,
    y<span class='op'>=</span><span class='st'>"cosine similarity"</span>,
       caption<span class='op'>=</span><span class='va'>my_caption</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_violin</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>indicator</span>,
                   y<span class='op'>=</span><span class='va'>cosine</span>,
                  fill<span class='op'>=</span><span class='va'>indicator</span><span class='op'>)</span>,
              color<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme_post</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>legend.position <span class='op'>=</span> <span class='st'>"none"</span>,
        axis.title.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_fill_manual</span><span class='op'>(</span>values<span class='op'>=</span><span class='va'>vec_color_submissions</span><span class='op'>)</span>
</code></pre>
</div>
</div>
</details>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-45-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p>I think the result shows quite clearly that those submissions which include the key phrase are much more similar to each other than all other groups of submission pairs even after having removed the key phrase. The graph also shows that those submission which do not contain the wording are hardly similar to each other.</p>
<h2 id="comparision-with-other-bills">Comparision with other bills</h2>
<p>But how does this result contrast with e.g. submissions to other bills. To put the results for the epidemic bill into context, I repeated the analysis from above for another bill, the 2018/19 Fundamental Law on Social Welfare (‘<a href="https://www.parlament.gv.at/PAKT/VHG/XXVI/ME/ME_00104/index.shtml#tab-Stellungnahmen" target="_blank">Sozialhilfegrundgesetz</a>’).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The plot below contrasts the distribution of cosine similarities between submission pairs.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="submissionsepidemiclaw_files/figure-html5/unnamed-chunk-47-1.svg" width="100%" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<p><br> I think the result is quite telling. In contrast to epidemic law, the values pertaining to the Law on Social Welfare are almost normally distributed and centered on the [0.3, 0.4) interval. In other words, there almost no submissions which are particularly similar or dissimilar. I would think that this is a distribution typical for submissions without the (prevalent) presence of a text template.</p>
<h1 id="wrap-up">Wrap up</h1>
<p>So that’s it (for now). Again, this got more lengthy than initially intended. A next step could be to see whether the similarity to submissions grew since the ability to file submissions via email. After all, copying a template, modifying it a bit before submission is not too difficult. Maybe as a final word, this is not to say that copy-and-paste submissions are of some sort of diminished democratic value. As always, if you have any comment or question regarding the post, feel free to contact me via DM on <a href="https://twitter.com/zoowalk" target="_blank">twitter.</a>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Note that the frequency of Tür und Tor quanteda result is different than the frequency I detected earlier. I am not entirely sure why this is, but I assume it’s due to different approaches. While our result above is the actual<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>I don’t reproduce the code for the analysis here, but it is available on my github.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2020-12-22-submissionsepidemiclaw/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Similarity%20of%20public%20submissions%20to%20Austria%27s%20amendment%20of%20the%20epidemic%20law&amp;url=https%3A%2F%2Fwerk.statt.codes%2Fposts%2F2020-12-22-submissionsepidemiclaw%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwerk.statt.codes%2Fposts%2F2020-12-22-submissionsepidemiclaw%2F&amp;title=Similarity%20of%20public%20submissions%20to%20Austria%27s%20amendment%20of%20the%20epidemic%20law">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fwerk.statt.codes%2Fposts%2F2020-12-22-submissionsepidemiclaw%2F">
        <i class="fab fa-facebook"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://werk.statt.codes.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/';
  this.page.identifier = 'posts/2020-12-22-submissionsepidemiclaw/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://werk.statt.codes.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Schmidt (2020, Dec. 22). werk.statt.codes: Similarity of public submissions to Austria's amendment of the epidemic law. Retrieved from https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{schmidt2020similarity,
  author = {Schmidt, Roland},
  title = {werk.statt.codes: Similarity of public submissions to Austria's amendment of the epidemic law},
  url = {https://werk.statt.codes/posts/2020-12-22-submissionsepidemiclaw/},
  year = {2020}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
